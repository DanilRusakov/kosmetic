<?php
class ModelExtensionModuleSearchHistory extends Model{public function add($a53ae1a759d233db7f351703b28684259='',$a9266cc248f816d2f9289eabd8fb8e9d8=0){if(!$a53ae1a759d233db7f351703b28684259){return false;}$ac24db625f5af45356118fc1be80032d0=$this->getIP();if(isset($this->session->data['search_history'])&&isset($this->session->data['search_history']['phrase'])&&strpos($a53ae1a759d233db7f351703b28684259,$this->session->data['search_history']['phrase'])===0){$a8fc75dfc2eef3d35a734e5f5b7512eea=$this->session->data['search_history']['search_history_id'];$this->db->query("UPDATE ".DB_PREFIX."search_history SET phrase = '".$this->db->escape($a53ae1a759d233db7f351703b28684259)."', date =  NOW(), ip = '".$this->db->escape($ac24db625f5af45356118fc1be80032d0)."', total_found = '".(int)$a9266cc248f816d2f9289eabd8fb8e9d8."' WHERE search_history_id = '".(int)$a8fc75dfc2eef3d35a734e5f5b7512eea."'");}else{$this->db->query("INSERT INTO ".DB_PREFIX."search_history SET phrase = '".$this->db->escape($a53ae1a759d233db7f351703b28684259)."', date =  NOW(), ip = '".$this->db->escape($ac24db625f5af45356118fc1be80032d0)."', total_found = '".(int)$a9266cc248f816d2f9289eabd8fb8e9d8."'");$a8fc75dfc2eef3d35a734e5f5b7512eea=$this->db->getLastId();}$this->session->data['search_history']=array('phrase'=>$a53ae1a759d233db7f351703b28684259,'search_history_id'=>$a8fc75dfc2eef3d35a734e5f5b7512eea);}private function getIP(){if(!empty($this->request->server['HTTP_X_REAL_IP'])){return $this->request->server['HTTP_X_REAL_IP'];}elseif(!empty($this->request->server['HTTP_CLIENT_IP'])){return $this->request->server['HTTP_CLIENT_IP'];}elseif(!empty($this->request->server['HTTP_X_FORWARDED_FOR'])){return $this->request->server['HTTP_X_FORWARDED_FOR'];}else{return $this->request->server['REMOTE_ADDR'];}}}
//author sv2109 (sv2109@gmail.com) license for 1 product copy granted for xdivers ( ivoryprof.ru)
